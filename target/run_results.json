{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-09-18T02:53:08.680278Z", "invocation_id": "e68d14e3-eaef-4be0-b15a-6bfe90975557", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:04.269408Z", "completed_at": "2025-09-18T02:53:04.458649Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:04.561597Z", "completed_at": "2025-09-18T02:53:06.005177Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.8066332340240479, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6bc2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.stg_transactions", "compiled": true, "compiled_code": "with source as (\n    select * from FAR_TRANS_DB.raw.transactions\n),\n\nrenamed as (\n    select\n        customerID as customer_id,\n        ISIN as isin,\n        transactionID as transaction_id,\n        transactionType as transaction_type,\n        timestamp::timestamp as transaction_date,\n        totalValue::decimal(20,4) as total_value,\n        units::decimal(20,4) as units,\n        channel,\n        marketID as market_id\n    from source\n)\n\nselect * from renamed", "relation_name": "FAR_TRANS_DB.RAW.stg_transactions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:04.227701Z", "completed_at": "2025-09-18T02:53:04.427233Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:04.470311Z", "completed_at": "2025-09-18T02:53:06.009694Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.813000202178955, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6bc6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.stg_close_prices", "compiled": true, "compiled_code": "with source as (\n    select * from FAR_TRANS_DB.raw.close_prices\n),\n\nrenamed as (\n    select\n        isin,\n        timestamp::timestamp as price_date,\n        closeprice::decimal(20,4) as close_price\n    from source\n)\n\nselect * from renamed", "relation_name": "FAR_TRANS_DB.RAW.stg_close_prices", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:04.248615Z", "completed_at": "2025-09-18T02:53:04.428372Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:04.528593Z", "completed_at": "2025-09-18T02:53:06.013283Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8156778812408447, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6bbe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.stg_customer_information", "compiled": true, "compiled_code": "with source as (\n    select * from FAR_TRANS_DB.raw.customer_information\n),\n\nrenamed as (\n    select\n        customerid as customer_id,\n        customertype as customer_type,\n        risklevel as risk_level,\n        investmentcapacity as investment_capacity,\n        lastquestionnairedate::date as last_questionnaire_date,\n        timestamp::timestamp as valid_from,\n        lead(timestamp::timestamp) over (partition by customerid order by timestamp) as valid_to\n    from source\n)\n\nselect * from renamed", "relation_name": "FAR_TRANS_DB.RAW.stg_customer_information", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:04.202625Z", "completed_at": "2025-09-18T02:53:04.425991Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:04.429315Z", "completed_at": "2025-09-18T02:53:06.016352Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.820587158203125, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6bca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.stg_asset_information", "compiled": true, "compiled_code": "with source as (\n    select * from FAR_TRANS_DB.raw.asset_information\n),\n\nrenamed as (\n    select\n        isin,\n        assetname as asset_name,\n        assetshortname as asset_short_name,\n        assetcategory as asset_category,\n        assetsubcategory as asset_sub_category,\n        marketid as market_id,\n        sector,\n        industry,\n        timestamp::timestamp as valid_from,\n        lead(timestamp::timestamp) over (partition by isin order by timestamp) as valid_to\n    from source\n)\n\nselect * from renamed", "relation_name": "FAR_TRANS_DB.RAW.stg_asset_information", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:06.038458Z", "completed_at": "2025-09-18T02:53:06.083175Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:06.084199Z", "completed_at": "2025-09-18T02:53:07.305885Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 1.271355390548706, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6c06"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.int_asset_daily_metrics", "compiled": true, "compiled_code": "with asset_info as (\n    select * from FAR_TRANS_DB.RAW.stg_asset_information\n    where valid_to is null  -- Get current asset information\n),\n\ndaily_prices as (\n    select * from FAR_TRANS_DB.RAW.stg_close_prices\n),\n\ndaily_returns as (\n    select\n        isin,\n        price_date,\n        close_price,\n        lag(close_price) over (partition by isin order by price_date) as prev_close_price,\n        (close_price - lag(close_price) over (partition by isin order by price_date)) / \n        lag(close_price) over (partition by isin order by price_date) as daily_return\n    from daily_prices\n)\n\nselect\n    dr.*,\n    ai.asset_name,\n    ai.asset_category,\n    ai.asset_sub_category,\n    ai.sector,\n    ai.industry\nfrom daily_returns dr\nleft join asset_info ai on dr.isin = ai.isin", "relation_name": "FAR_TRANS_DB.RAW.int_asset_daily_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:06.060769Z", "completed_at": "2025-09-18T02:53:06.089886Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:06.106329Z", "completed_at": "2025-09-18T02:53:07.358012Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 1.3222827911376953, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6c0a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.int_customer_transactions", "compiled": true, "compiled_code": "with customer_info as (\n    select * from FAR_TRANS_DB.RAW.stg_customer_information\n    where valid_to is null  -- Get current customer information\n),\n\ntransactions as (\n    select * from FAR_TRANS_DB.RAW.stg_transactions\n),\n\nasset_info as (\n    select * from FAR_TRANS_DB.RAW.stg_asset_information\n    where valid_to is null  -- Get current asset information\n)\n\nselect\n    t.transaction_id,\n    t.customer_id,\n    t.isin,\n    t.transaction_type,\n    t.transaction_date,\n    t.total_value,\n    t.units,\n    t.channel,\n    t.market_id,\n    ci.customer_type,\n    ci.risk_level,\n    ci.investment_capacity,\n    ai.asset_name,\n    ai.asset_category,\n    ai.sector\nfrom transactions t\nleft join customer_info ci on t.customer_id = ci.customer_id\nleft join asset_info ai on t.isin = ai.isin", "relation_name": "FAR_TRANS_DB.RAW.int_customer_transactions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:07.313616Z", "completed_at": "2025-09-18T02:53:07.334051Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:07.334860Z", "completed_at": "2025-09-18T02:53:08.517892Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 1.206430196762085, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6c42"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.mart_asset_performance", "compiled": true, "compiled_code": "with daily_metrics as (\n    select * from FAR_TRANS_DB.RAW.int_asset_daily_metrics\n),\n\nasset_stats as (\n    select\n        isin,\n        asset_name,\n        asset_category,\n        asset_sub_category,\n        sector,\n        industry,\n        min(price_date) as first_trading_date,\n        max(price_date) as last_trading_date,\n        min(close_price) as min_price,\n        max(close_price) as max_price,\n        avg(close_price) as avg_price,\n        avg(daily_return) as avg_daily_return,\n        stddev(daily_return) as daily_volatility,\n        count(*) as trading_days\n    from daily_metrics\n    where daily_return is not null\n    group by 1,2,3,4,5,6\n)\n\nselect * from asset_stats", "relation_name": "FAR_TRANS_DB.RAW.mart_asset_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-18T02:53:07.370226Z", "completed_at": "2025-09-18T02:53:07.390455Z"}, {"name": "execute", "started_at": "2025-09-18T02:53:07.391279Z", "completed_at": "2025-09-18T02:53:08.665707Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.2974624633789062, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bf1fcd-030e-dd8f-000d-775b00df6c4a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbt_investment_FAR_TRANS.mart_customer_portfolio", "compiled": true, "compiled_code": "with customer_transactions as (\n    select * from FAR_TRANS_DB.RAW.int_customer_transactions\n),\n\ncustomer_portfolio as (\n    select\n        customer_id,\n        customer_type,\n        risk_level,\n        investment_capacity,\n        count(distinct transaction_id) as total_transactions,\n        count(distinct isin) as unique_assets,\n        sum(case when transaction_type = 'Buy' then total_value else 0 end) as total_purchases,\n        sum(case when transaction_type = 'Sell' then total_value else 0 end) as total_sales,\n        sum(case when transaction_type = 'Buy' then total_value else -total_value end) as net_investment,\n        count(distinct asset_category) as asset_categories_traded,\n        count(distinct sector) as sectors_invested,\n        min(transaction_date) as first_transaction_date,\n        max(transaction_date) as last_transaction_date\n    from customer_transactions\n    group by 1,2,3,4\n)\n\nselect * from customer_portfolio", "relation_name": "FAR_TRANS_DB.RAW.mart_customer_portfolio", "batch_results": null}], "elapsed_time": 7.368951320648193, "args": {"partial_parse": true, "which": "run", "skip_nodes_if_on_run_start_fails": false, "partial_parse_file_diff": true, "exclude": [], "populate_cache": true, "introspect": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "show_resource_report": false, "print": true, "log_level": "info", "indirect_selection": "eager", "quiet": false, "log_path": "/tmp/dbt/logs", "log_format": "default", "require_resource_names_without_spaces": false, "cache_selected_only": false, "state_modified_compare_more_unrendered_values": false, "defer": false, "profiles_dir": "/tmp/dbt/", "state_modified_compare_vars": false, "source_freshness_run_project_hooks": false, "log_level_file": "debug", "static_parser": true, "use_colors": true, "log_file_max_bytes": 10485760, "macro_debugging": false, "target": "prod", "require_yaml_configuration_for_mf_time_spines": false, "invocation_command": "dbt ", "log_format_file": "debug", "require_nested_cumulative_type_params": false, "favor_state": false, "printer_width": 80, "version_check": true, "strict_mode": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_batched_execution_for_custom_microbatch_strategy": false, "send_anonymous_usage_stats": false, "project_dir": "/tmp/dbt", "target_path": "/tmp/dbt/target/", "use_colors_file": true, "write_json": true, "select": [], "empty": false}}